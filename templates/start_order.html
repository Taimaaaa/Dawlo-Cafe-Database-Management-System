{% extends "base.html" %}
{% block content %}

<div class="card">
  <h2>Start New Order</h2>

  {% if error %}
    <p style="color:red;">{{ error }}</p>
  {% endif %}

  <form method="post">

    <label>Customer</label>
    <select name="customer_id" required>
      {% for c in customers %}
        <option value="{{ c.customer_id }}">{{ c.customer_name }}</option>
      {% endfor %}
    </select>

    <label>Order Type</label>
    <select name="order_type" id="order_type">
      <option value="dine_in"
        {% if selected_table %}selected{% endif %}
      >
        Dine In
      </option>
      <option value="takeaway"
        {% if not selected_table %}selected{% endif %}
      >
        Takeaway
      </option>
    </select>


    <div id="dine_in_fields">
      <label>Table</label>
      <select name="table_id" id="table_id">
        {% for t in tables %}
          <option value="{{ t.table_id }}"
            {% if selected_table == t.table_id %}selected{% endif %}
          >
            Table {{ t.table_id }} (Capacity: {{ t.capacity }})
          </option>
        {% endfor %}
      </select>


      <label>Party Size</label>
      <input type="number" name="party_size" min="1">
    </div>

    <button type="submit">Create Order</button>
  </form>
</div>

<script>
  const orderType = document.getElementById("order_type");
  const dineFields = document.getElementById("dine_in_fields");

  function toggleFields() {
    dineFields.style.display = orderType.value === "dine_in" ? "block" : "none";
  }

  orderType.addEventListener("change", toggleFields);
  toggleFields();
</script>

{% endblock %}