{% extends "base.html" %}
{% block content %}

<div class="card">
  <h2>Shift History</h2>

  <p style="opacity:0.8; margin-bottom:16px;">
    {{ employee.emp_name }} — {{ employee.position_title }}
  </p>

  {# ================= CLOCK IN / OUT ================= #}
  {% if session.get("emp_id") == request.view_args.emp_id %}
    {% if not has_active_shift %}
      <form method="POST" action="{{ url_for('clock_in') }}">
        <input type="hidden" name="emp_id" value="{{ session.emp_id }}">
        <button type="submit" class="btn">
          ⏱ Clock In
        </button>
      </form>
    {% else %}
      <form method="POST" action="{{ url_for('clock_out') }}">
        <input type="hidden" name="emp_id" value="{{ session.emp_id }}">
        <button type="submit" class="btn danger">
          ⏹ Clock Out
        </button>
      </form>
    {% endif %}
  {% endif %}

  <br>

  {% if shifts %}
    <table>
      <tr>
        <th>Start</th>
        <th>End</th>
        <th>Duration</th>
      </tr>

      {% for s in shifts %}
      <tr>
        <td>{{ s.shift_start }}</td>
        <td>
          {% if s.shift_end %}
            {{ s.shift_end }}
          {% else %}
            <span class="badge">Ongoing</span>
          {% endif %}
        </td>
        <td>{{ s.duration_min }} min</td>
      </tr>
      {% endfor %}
    </table>
  {% else %}
    <p class="empty">No shifts recorded.</p>
  {% endif %}

  {% if session.get("position_title") == "manager" %}
    <a href="{{ url_for('employees_dashboard') }}" class="btn-secondary">
      ← Back to Employees
    </a>
  {% endif %}

</div>

{% endblock %}
